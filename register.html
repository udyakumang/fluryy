<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Fluryy â€” Register</title>
  <link rel="stylesheet" href="/css/styles.css?v=1.2.8"/>
</head>
<body>
  <main class="container" style="max-width:420px;padding:2rem 1rem">
    <h1>Register</h1>
    <form id="register-form" novalidate>
      <label>Email<input type="email" class="input" name="email" required></label>
      <label>Role
        <select class="input" name="role" required>
          <option value="parent">Pet Parent</option>
          <option value="groomer">Groomer</option>
        </select>
      </label>
      <button class="btn" type="submit">Send Magic Link</button>
    </form>
    <p>Already have an account? <a href="/login.html">Login</a></p>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.3/dist/umd/supabase.js"></script>
  <script>
    const supa = supabase.createClient(
      'https://qfldkqowlqkokpqwqdpl.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFmbGRrcW93bHFrb2twcXdxZHBsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0ODIxNTMsImV4cCI6MjA3MzA1ODE1M30.TtzlGJIl0Vmn2nI2plqnNvq4NaVH1urNgch982glytg' // anon key
    );
    document.getElementById('register-form').addEventListener('submit', async e=>{
      e.preventDefault();
      const email = e.target.email.value;
      const role = e.target.role.value;
      const { error } = await supa.auth.signInWithOtp({
        email,
        options:{ data:{ role } }
      });
      alert(error ? 'Error: '+error.message : 'Magic link sent! Check your inbox.');
    });
  </script>
</body>
</html>
