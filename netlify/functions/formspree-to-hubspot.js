export const handler=async(e)=>{if(e.httpMethod!=='POST')return{statusCode:405,body:'Method not allowed'};const t=process.env.HUBSPOT_PRIVATE_APP_TOKEN;if(!t)return{statusCode:500,body:'Missing HUBSPOT_PRIVATE_APP_TOKEN'};try{const p=JSON.parse(e.body||'{}');const n=p.name||'';const m=p.email||'';const ph=p.phone||'';const r=await fetch('https://api.hubapi.com/crm/v3/objects/contacts',{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${t}`},body:JSON.stringify({properties:{email:m,firstname:n.split(' ')[0]||'',lastname:n.split(' ').slice(1).join(' ')||'Fluryy',phone:ph}})});return{statusCode:r.ok?200:502,body:r.ok?'{"ok":true}':'{"error":"HubSpot failed"}'};}catch(e2){return{statusCode:500,body:JSON.stringify({error:'Server error',detail:e2?.message})}}};